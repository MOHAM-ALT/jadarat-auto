<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>جدارات أوتو</title>
    <link rel="stylesheet" href="styles/popup.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <span class="logo-icon">🎯</span>
                <h1>جدارات أوتو</h1>
            </div>
            <button class="close-btn" id="closeBtn">×</button>
        </div>

        <!-- Main Sections -->
        <div class="main-content">
            
            <!-- Status Section -->
            <div class="section status-section">
                <div class="section-header">
                    <span class="section-icon">🔗</span>
                    <h2>حالة الاتصال</h2>
                </div>
                
                <div class="connection-status" id="connectionStatus">
                    <div class="status-indicator" id="statusIndicator">
                        <span class="status-dot"></span>
                        <span id="statusText">جاري الفحص...</span>
                    </div>
                    <div class="connection-details" id="connectionDetails">
                        <span class="detail-text">فحص الاتصال مع الصفحة...</span>
                    </div>
                </div>
            </div>
            
            <!-- Control Panel -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">⚡</span>
                    <h2>لوحة التحكم</h2>
                </div>
                
                <div class="control-buttons">
                    <button class="btn btn-primary" id="startBtn" disabled>
                        <span class="btn-icon">▶</span>
                        بدء التشغيل
                    </button>
                    <button class="btn btn-secondary" id="pauseBtn" disabled>
                        <span class="btn-icon">⏸</span>
                        إيقاف مؤقت
                    </button>
                    <button class="btn btn-danger" id="stopBtn" disabled>
                        <span class="btn-icon">⏹</span>
                        إيقاف نهائي
                    </button>
                </div>
            </div>

            <!-- Settings -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">⚙</span>
                    <h2>الإعدادات المتقدمة</h2>
                    <span class="pro-badge">PRO</span>
                </div>

                <div class="settings-grid">
                    <div class="setting-item">
                        <label>فترة الانتظار (ثانية)</label>
                        <div class="input-group">
                            <input type="range" id="delayRange" min="2" max="10" value="3">
                            <span id="delayValue">3</span>
                        </div>
                    </div>

                    <div class="setting-item">
                        <label>نمط التشغيل</label>
                        <select id="modeSelect" class="select-input">
                            <option value="normal">عادي</option>
                            <option value="smart">ذكي</option>
                            <option value="fast">سريع</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label>صوت التنبيهات</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="soundToggle" checked>
                            <span class="slider"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">📊</span>
                    <h2>إحصائيات الجلسة</h2>
                </div>

                <div class="stats-grid">
                    <div class="stat-card success">
                        <div class="stat-number" id="appliedCount">0</div>
                        <div class="stat-label">تم التقديم</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-number" id="rejectedCount">0</div>
                        <div class="stat-label">تم الرفض</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-number" id="skippedCount">0</div>
                        <div class="stat-label">تم التخطي</div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-number" id="totalCount">0</div>
                        <div class="stat-label">إجمالي الوظائف</div>
                    </div>
                </div>
            </div>

            <!-- Progress Section -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">📈</span>
                    <h2>التقدم الحالي</h2>
                </div>

                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                        <div class="progress-percentage" id="progressPercentage">0%</div>
                    </div>
                    <div class="progress-text" id="progressText">جاهز للبدء</div>
                </div>

                <div class="current-job" id="currentJob">
                    <span class="job-status">في الانتظار...</span>
                </div>
            </div>

            <!-- Resume Operations -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">🔄</span>
                    <h2>استئناف العمليات</h2>
                </div>

                <div class="resume-buttons">
                    <button class="btn btn-info" id="resumeBtn" disabled>
                        <span class="btn-icon">🔄</span>
                        استكمال من النقطة الأخيرة
                    </button>
                    <button class="btn btn-warning" id="restartBtn" disabled>
                        <span class="btn-icon">🔄</span>
                        البدء من جديد
                    </button>
                </div>
            </div>

            <!-- Rejection Data Section -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">📋</span>
                    <h2>بيانات الرفض</h2>
                    <span class="feature-badge">جديد</span>
                </div>

                <div class="rejection-buttons">
                    <button class="btn btn-success" id="exportBtn" disabled>
                        <span class="btn-icon">📥</span>
                        تصدير للاكسل
                    </button>
                    <button class="btn btn-warning" id="clearRejectionBtn" disabled>
                        <span class="btn-icon">🗑</span>
                        مسح البيانات
                    </button>
                    <button class="btn btn-danger" id="clearRejectedJobsBtn" disabled>
    <span class="btn-icon">🚫</span>
    مسح الوظائف المرفوضة
</button>
                </div>

                <div class="rejection-info" id="rejectionInfo">
                    <span class="info-text">لا توجد بيانات رفض بعد</span>
                </div>
            </div>

            <!-- Debug Section (يظهر فقط عند وجود مشاكل) -->
            <div class="section debug-section" id="debugSection" style="display: none;">
                <div class="section-header">
                    <span class="section-icon">🐛</span>
                    <h2>معلومات التشخيص</h2>
                </div>

                <div class="debug-info">
                    <div class="debug-item">
                        <label>نوع الصفحة:</label>
                        <span id="debugPageType">-</span>
                    </div>
                    <div class="debug-item">
                        <label>URL الحالي:</label>
                        <span id="debugCurrentUrl">-</span>
                    </div>
                    <div class="debug-item">
                        <label>آخر خطأ:</label>
                        <span id="debugLastError">-</span>
                    </div>
                </div>

                <div class="debug-buttons">
                    <button class="btn btn-info" id="debugReconnectBtn">
                        <span class="btn-icon">🔌</span>
                        إعادة الاتصال
                    </button>
                    <button class="btn btn-warning" id="debugReloadBtn">
                        <span class="btn-icon">🔄</span>
                        إعادة تحميل الصفحة
                    </button>
                </div>
            </div>

        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-status">
                <div class="status-indicator" id="footerStatusIndicator">
                    <span class="status-dot"></span>
                    <span id="footerStatusText">غير متصل</span>
                </div>
                <div class="version">v1.0.1</div>
            </div>
            
            <div class="footer-links">
                <button class="link-btn" id="helpBtn">مساعدة</button>
                <button class="link-btn" id="aboutBtn">حول</button>
            </div>
        </div>

    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-spinner"></div>
        <div class="loading-text">جاري التحميل...</div>
    </div>

    <!-- Error Modal -->
    <div class="error-modal" id="errorModal" style="display: none;">
        <div class="error-content">
            <div class="error-header">
                <span class="error-icon">⚠️</span>
                <h3>خطأ في الاتصال</h3>
            </div>
            <div class="error-body">
                <p id="errorMessage">حدث خطأ غير متوقع</p>
                <div class="error-suggestions">
                    <h4>الحلول المقترحة:</h4>
                    <ul>
                        <li>تأكد من أنك في موقع جدارات (jadarat.sa)</li>
                        <li>قم بإعادة تحميل الصفحة</li>
                        <li>أعد تشغيل المتصفح</li>
                    </ul>
                </div>
            </div>
            <div class="error-footer">
                <button class="btn btn-primary" id="errorRetryBtn">إعادة المحاولة</button>
                <button class="btn btn-secondary" id="errorCloseBtn">إغلاق</button>
            </div>
        </div>
    </div>

    <script src="popup.js"></script>
</body>
</html>